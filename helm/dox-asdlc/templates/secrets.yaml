{{/*
Secrets for the dox-asdlc system.
WARNING: Default values are placeholders only. Override in production.
*/}}

{{- if .Values.secrets.redis.create }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "dox-asdlc.redisSecretName" . }}
  namespace: {{ include "dox-asdlc.namespace" . }}
  labels:
    {{- include "dox-asdlc.labels" . | nindent 4 }}
type: Opaque
data:
  {{- if .Values.secrets.redis.password }}
  redis-password: {{ .Values.secrets.redis.password | b64enc | quote }}
  {{- else }}
  # WARNING: No password set. Override with --set secrets.redis.password=<value>
  redis-password: {{ "" | b64enc | quote }}
  {{- end }}
{{- end }}

{{- if .Values.secrets.git.create }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "dox-asdlc.gitSecretName" . }}
  namespace: {{ include "dox-asdlc.namespace" . }}
  labels:
    {{- include "dox-asdlc.labels" . | nindent 4 }}
type: Opaque
data:
  {{- if .Values.secrets.git.username }}
  username: {{ .Values.secrets.git.username | b64enc | quote }}
  {{- else }}
  # WARNING: No username set. Override with --set secrets.git.username=<value>
  username: {{ "" | b64enc | quote }}
  {{- end }}
  {{- if .Values.secrets.git.token }}
  token: {{ .Values.secrets.git.token | b64enc | quote }}
  {{- else }}
  # WARNING: No token set. Override with --set secrets.git.token=<value>
  token: {{ "" | b64enc | quote }}
  {{- end }}
{{- end }}

{{- if .Values.secrets.apiKeys.create }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "dox-asdlc.apiKeysSecretName" . }}
  namespace: {{ include "dox-asdlc.namespace" . }}
  labels:
    {{- include "dox-asdlc.labels" . | nindent 4 }}
type: Opaque
data:
  {{- if .Values.secrets.apiKeys.claudeApiKey }}
  claude-api-key: {{ .Values.secrets.apiKeys.claudeApiKey | b64enc | quote }}
  {{- else }}
  # WARNING: No Claude API key set. Override with --set secrets.apiKeys.claudeApiKey=<value>
  claude-api-key: {{ "" | b64enc | quote }}
  {{- end }}
{{- end }}
